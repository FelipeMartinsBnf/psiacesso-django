{% extends 'base.html' %}
{% load static %}

{% block title %}Meu Perfil - PsiConnect{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'perfil-paciente.css' %}">
{% endblock %}

{% block content %}
<div class="profile-container">

    <!-- Cabe√ßalho da P√°gina (T√≠tulo e Subt√≠tulo) -->
    <div class="page-header">
        <div>
            <h2>Meu Perfil</h2>
            <p>Gerencie suas informa√ß√µes pessoais e prefer√™ncias</p>
        </div>
        <button class="btn-dark-outline">
            <span class="material-icons">edit</span> Editar Perfil
        </button>
    </div>

    <div class="profile-layout">
        
        <!-- COLUNA ESQUERDA: Card do Usu√°rio -->
        <aside class="profile-sidebar">
            <div class="card user-card">
                <div class="profile-image-wrapper">
                    {% if user.profile.photo %}
                        <img src="{{ user.profile.photo.url }}" alt="Foto de {{ user.first_name }}">
                    {% else %}
                        <img src="https://placehold.co/150x150/png?text={{ user.first_name|first }}" alt="Sem foto">
                    {% endif %}
                    <button class="btn-icon camera-icon">üì∑</button>
                </div>

                <h3 class="user-name">{{ user.first_name }} {{ user.last_name }}</h3>
                <p class="user-since">Usu√°rio desde {{ user.date_joined|date:"F Y" }}</p>

                <div class="verified-badge">
                    <span class="material-icons">check_circle</span>
                    Perfil Verificado
                </div>
            </div>
        </aside>

        <!-- COLUNA DIREITA: Formul√°rio e Configura√ß√µes -->
        <main class="profile-content">
            
            <!-- FORMUL√ÅRIO DE INFORMA√á√ïES PESSOAIS -->
            <form method="POST" class="card form-section">
                {% csrf_token %}
                
                <div class="card-header">
                    <h3><span class="material-icons">person</span> Informa√ß√µes Pessoais</h3>
                </div>

                <div class="form-grid">
                    <!-- Linha 1 -->
                    <div class="form-group">
                        <label>Nome Completo</label>
                        <input type="text" name="nome" value="{{ user.first_name }} {{ user.last_name }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Data de Nascimento</label>
                        <!-- Assumindo que existe data_nascimento no perfil -->
                        <input type="date" name="nascimento" value="{{ user.paciente.data_nascimento|date:'Y-m-d' }}" class="form-input">
                    </div>

                    <!-- Linha 2 -->
                    <div class="form-group">
                        <label>E-mail</label>
                        <input type="email" name="email" value="{{ user.email }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Telefone</label>
                        <input type="text" name="telefone" value="{{ user.paciente.telefone }}" class="form-input">
                    </div>

                    <!-- Linha 3 -->
                    <div class="form-group">
                        <label>CPF</label>
                        <input type="text" name="cpf" value="{{ user.paciente.cpf }}" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>CEP</label>
                        <input type="text" name="cep" value="{{ user.paciente.cep }}" class="form-input">
                    </div>

                    <!-- Linha 4 (Full Width) -->
                    <div class="form-group full-width">
                        <label>Endere√ßo Completo</label>
                        <input type="text" name="endereco" value="{{ user.paciente.endereco }}" class="form-input">
                    </div>
                </div>

                <div class="form-footer">
                    <span class="last-update">√öltima atualiza√ß√£o: 15 de dezembro de 2024</span>
                    <div class="form-actions">
                        <button type="button" class="btn-cancel">Cancelar</button>
                        <button type="submit" class="btn-save">Salvar Altera√ß√µes</button>
                    </div>
                </div>
            </form>

            <!-- GRID INFERIOR: Privacidade e Prefer√™ncias -->
            <div class="bottom-grid">
                
                <!-- Card Privacidade -->
                <div class="card small-card">
                    <div class="card-header">
                        <h3><span class="material-icons">security</span> Privacidade e Seguran√ßa</h3>
                    </div>
                    <ul class="settings-list">
                        <li>
                            <span>Verifica√ß√£o em duas etapas</span>
                            <span class="badge badge-green">Ativado</span>
                        </li>
                        <li>
                            <span>Notifica√ß√µes por e-mail</span>
                            <span class="badge badge-gray">Desativado</span>
                        </li>
                        <li>
                            <a href="#" class="link-action">Alterar senha</a>
                        </li>
                    </ul>
                </div>

                <!-- Card Prefer√™ncias -->
                <div class="card small-card">
                    <div class="card-header">
                        <h3><span class="material-icons">settings</span> Prefer√™ncias</h3>
                    </div>
                    <ul class="settings-list">
                        <li>
                            <span>Tema escuro</span>
                            <span class="badge badge-gray">Desativado</span>
                        </li>
                        <li>
                            <span>Idioma</span>
                            <span class="text-detail">Portugu√™s (BR)</span>
                        </li>
                        <li>
                            <span>Fuso hor√°rio</span>
                            <span class="text-detail">GMT-3</span>
                        </li>
                    </ul>
                </div>

            </div>

        </main>
    </div>
</div>
{% endblock %}